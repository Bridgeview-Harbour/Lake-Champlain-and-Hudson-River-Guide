/**
 * Lake Champlain & Hudson River Boater's Guide
 * Water-Based Navigation Routing with Grid Pathfinding
 *
 * Uses a high-resolution water polygon and grid-based A* pathfinding
 * to ensure routes stay on navigable water and never cross land.
 */

// ============================================
// Lake Champlain Water Polygon - FROM KMZ DATA
// ============================================
// 1624 vertices extracted from official KMZ boundary file
// lake-data/lake_champlain_boundary.kmz

const LAKE_CHAMPLAIN_POLYGON = [
    [45.085126, -73.142236],
    [45.082113, -73.131441],
    [45.076818, -73.130678],
    [45.072706, -73.132402],
    [45.067171, -73.135209],
    [45.063047, -73.136453],
    [45.059343, -73.136445],
    [45.063738, -73.133653],
    [45.068098, -73.130800],
    [45.070524, -73.127549],
    [45.072092, -73.122407],
    [45.073286, -73.118219],
    [45.073362, -73.112260],
    [45.072504, -73.105325],
    [45.071009, -73.095529],
    [45.067160, -73.087967],
    [45.063078, -73.081521],
    [45.058508, -73.077470],
    [45.054976, -73.078064],
    [45.050681, -73.077370],
    [45.042495, -73.076080],
    [45.039893, -73.078530],
    [45.038512, -73.079193],
    [45.035693, -73.084610],
    [45.028499, -73.088883],
    [45.022895, -73.090645],
    [45.018667, -73.089908],
    [45.013833, -73.091421],
    [45.008918, -73.091419],
    [45.002180, -73.091697],
    [44.997869, -73.091178],
    [44.994150, -73.088665],
    [44.990891, -73.087594],
    [44.987112, -73.091668],
    [44.985497, -73.096104],
    [44.984987, -73.099101],
    [44.982395, -73.099563],
    [44.981329, -73.104230],
    [44.982580, -73.106115],
    [44.979680, -73.108194],
    [44.977383, -73.111280],
    [44.975124, -73.114402],
    [44.974176, -73.117475],
    [44.973973, -73.121511],
    [44.972733, -73.125383],
    [44.974686, -73.125203],
    [44.976160, -73.121717],
    [44.977232, -73.124411],
    [44.975592, -73.126468],
    [44.976541, -73.129181],
    [44.976518, -73.132421],
    [44.974342, -73.135772],
    [44.975871, -73.140935],
    [44.977863, -73.143936],
    [44.979572, -73.145854],
    [44.982383, -73.144631],
    [44.984949, -73.138996],
    [44.986713, -73.136922],
    [44.988200, -73.138348],
    [44.985307, -73.141376],
    [44.984862, -73.145934],
    [44.986948, -73.147514],
    [44.989400, -73.148535],
    [44.993449, -73.146513],
    [44.998402, -73.143693],
    [45.001233, -73.139007],
    [45.003542, -73.136907],
    [45.005485, -73.135752],
    [45.007841, -73.135412],
    [45.007897, -73.139042],
    [45.008803, -73.144348],
    [45.011675, -73.144468],
    [45.009205, -73.148203],
    [45.007718, -73.149936],
    [45.006829, -73.153589],
    [45.006094, -73.157589],
    [45.006757, -73.161566],
    [45.004947, -73.162290],
    [45.002264, -73.159780],
    [45.000183, -73.155843],
    [44.997918, -73.153826],
    [44.995374, -73.154596],
    [44.996466, -73.157383],
    [44.994358, -73.156805],
    [44.990042, -73.155958],
    [44.983853, -73.156595],
    [44.984568, -73.157526],
    [44.987710, -73.156596],
    [44.991443, -73.156167],
    [44.994010, -73.158035],
    [44.997140, -73.159544],
    [44.996221, -73.161236],
    [44.994290, -73.163426],
    [44.990885, -73.164231],
    [44.988432, -73.164831],
    [44.982395, -73.166135],
    [44.977224, -73.166056],
    [44.978794, -73.170588],
    [44.978685, -73.173465],
    [44.975798, -73.171590],
    [44.972234, -73.171721],
    [44.973926, -73.174760],
    [44.975093, -73.172522],
    [44.976840, -73.173138],
    [44.975891, -73.175440],
    [44.972116, -73.177587],
    [44.969422, -73.174102],
    [44.969265, -73.176016],
    [44.970684, -73.177976],
    [44.970103, -73.180977],
    [44.974420, -73.178009],
    [44.977563, -73.175462],
    [44.979661, -73.174247],
    [44.985977, -73.168658],
    [44.989849, -73.167403],
    [44.991000, -73.171475],
    [44.993040, -73.176737],
    [44.991880, -73.181476],
    [44.989047, -73.184815],
    [44.984221, -73.186813],
    [44.980703, -73.190561],
    [44.978662, -73.193217],
    [44.975382, -73.196227],
    [44.974554, -73.199950],
    [44.973598, -73.202552],
    [44.975421, -73.204112],
    [44.973785, -73.209107],
    [44.970816, -73.210879],
    [44.972718, -73.219345],
    [44.968776, -73.213361],
    [44.962954, -73.215738],
    [44.959465, -73.218854],
    [44.954345, -73.221589],
    [44.946601, -73.225531],
    [44.940349, -73.227410],
    [44.934839, -73.226314],
    [44.932590, -73.222723],
    [44.929638, -73.221756],
    [44.929070, -73.219022],
    [44.928390, -73.215953],
    [44.924805, -73.215256],
    [44.923187, -73.212869],
    [44.925672, -73.208394],
    [44.930976, -73.204712],
    [44.935195, -73.200592],
    [44.935997, -73.196216],
    [44.935773, -73.191122],
    [44.934999, -73.187703],
    [44.934631, -73.183675],
    [44.933151, -73.179844],
    [44.931682, -73.175776],
    [44.930247, -73.172603],
    [44.928009, -73.167986],
    [44.924217, -73.163601],
    [44.920606, -73.161032],
    [44.918123, -73.162190],
    [44.914909, -73.162956],
    [44.911930, -73.164200],
    [44.906628, -73.166610],
    [44.900707, -73.167093],
    [44.894976, -73.167509],
    [44.889395, -73.169318],
    [44.884145, -73.172593],
    [44.876611, -73.177491],
    [44.873593, -73.179288],
    [44.871911, -73.182284],
    [44.870630, -73.180913],
    [44.864300, -73.181930],
    [44.860866, -73.182973],
    [44.852189, -73.183609],
    [44.845097, -73.183775],
    [44.840710, -73.184208],
    [44.835890, -73.185257],
    [44.831504, -73.187568],
    [44.826559, -73.189412],
    [44.819784, -73.190081],
    [44.816127, -73.190748],
    [44.812913, -73.191858],
    [44.811326, -73.192889],
    [44.810179, -73.191425],
    [44.813464, -73.189966],
    [44.817201, -73.186932],
    [44.815879, -73.179108],
    [44.813325, -73.176650],
    [44.813110, -73.175325],
    [44.812251, -73.171898],
    [44.810002, -73.170740],
    [44.807638, -73.170170],
    [44.805373, -73.170710],
    [44.802811, -73.172227],
    [44.801532, -73.176766],
    [44.802831, -73.179298],
    [44.799814, -73.180996],
    [44.798040, -73.184188],
    [44.794636, -73.185263],
    [44.790992, -73.186987],
    [44.786844, -73.188035],
    [44.783484, -73.186968],
    [44.781222, -73.183667],
    [44.778380, -73.184113],
    [44.779546, -73.179946],
    [44.779602, -73.174621],
    [44.782979, -73.174974],
    [44.786340, -73.173864],
    [44.794052, -73.172900],
    [44.794840, -73.166842],
    [44.796423, -73.162882],
    [44.801289, -73.158298],
    [44.805174, -73.156973],
    [44.808516, -73.154047],
    [44.810279, -73.149120],
    [44.808474, -73.141424],
    [44.806223, -73.138125],
    [44.803531, -73.136618],
    [44.798461, -73.137335],
    [44.792356, -73.140171],
    [44.787141, -73.143055],
    [44.787582, -73.147128],
    [44.785764, -73.147899],
    [44.781816, -73.150125],
    [44.778124, -73.151615],
    [44.775540, -73.157380],
    [44.771220, -73.158847],
    [44.769404, -73.162136],
    [44.763457, -73.163323],
    [44.760955, -73.167832],
    [44.758402, -73.172320],
    [44.759232, -73.176546],
    [44.755702, -73.181703],
    [44.751346, -73.182511],
    [44.747380, -73.186329],
    [44.742899, -73.193488],
    [44.735335, -73.197306],
    [44.728650, -73.200374],
    [44.725813, -73.201605],
    [44.721329, -73.204776],
    [44.716252, -73.206817],
    [44.711437, -73.207968],
    [44.706779, -73.209220],
    [44.701671, -73.210021],
    [44.698594, -73.211809],
    [44.694325, -73.212297],
    [44.688009, -73.211406],
    [44.682399, -73.210809],
    [44.677339, -73.210887],
    [44.673775, -73.210745],
    [44.669273, -73.212150],
    [44.664610, -73.211990],
    [44.660373, -73.213174],
    [44.652314, -73.213258],
    [44.648902, -73.212144],
    [44.645808, -73.211437],
    [44.643562, -73.209646],
    [44.640991, -73.208973],
    [44.637931, -73.209342],
    [44.635231, -73.212872],
    [44.633718, -73.216125],
    [44.631121, -73.223553],
    [44.628734, -73.230701],
    [44.627839, -73.240565],
    [44.631594, -73.255770],
    [44.628747, -73.247845],
    [44.625523, -73.239612],
    [44.622525, -73.237289],
    [44.620943, -73.239203],
    [44.618310, -73.240526],
    [44.619784, -73.243987],
    [44.618293, -73.246346],
    [44.616695, -73.248891],
    [44.614006, -73.243540],
    [44.610179, -73.236656],
    [44.610958, -73.233373],
    [44.607732, -73.228605],
    [44.600218, -73.228563],
    [44.594126, -73.228578],
    [44.590850, -73.229642],
    [44.586405, -73.226449],
    [44.582214, -73.227329],
    [44.578812, -73.226784],
    [44.579861, -73.221837],
    [44.580318, -73.219084],
    [44.579210, -73.217371],
    [44.578437, -73.216448],
    [44.576972, -73.214526],
    [44.576979, -73.213536],
    [44.575169, -73.213180],
    [44.574119, -73.212448],
    [44.573367, -73.209985],
    [44.576054, -73.210006],
    [44.577300, -73.207347],
    [44.577622, -73.204977],
    [44.574834, -73.202446],
    [44.575463, -73.200417],
    [44.578542, -73.197325],
    [44.579280, -73.195422],
    [44.581497, -73.194344],
    [44.582079, -73.188217],
    [44.579645, -73.183199],
    [44.575714, -73.186722],
    [44.572541, -73.185093],
    [44.570650, -73.183827],
    [44.571272, -73.178974],
    [44.573267, -73.176359],
    [44.575002, -73.173702],
    [44.574923, -73.169972],
    [44.574216, -73.168918],
    [44.574018, -73.171507],
    [44.574572, -73.174940],
    [44.572585, -73.176154],
    [44.569237, -73.181291],
    [44.569289, -73.185129],
    [44.565720, -73.190747],
    [44.562306, -73.189482],
    [44.558582, -73.190820],
    [44.556512, -73.193302],
    [44.553618, -73.192937],
    [44.548183, -73.201887],
    [44.545542, -73.211590],
    [44.546999, -73.219483],
    [44.549769, -73.224655],
    [44.552105, -73.229581],
    [44.553351, -73.225640],
    [44.555260, -73.222590],
    [44.554683, -73.219893],
    [44.556819, -73.217739],
    [44.558256, -73.219805],
    [44.556628, -73.222502],
    [44.556961, -73.223273],
    [44.556982, -73.225796],
    [44.553613, -73.229852],
    [44.553434, -73.233128],
    [44.556772, -73.233417],
    [44.560206, -73.229834],
    [44.563222, -73.230088],
    [44.565035, -73.231981],
    [44.569738, -73.230999],
    [44.572549, -73.232522],
    [44.572076, -73.236016],
    [44.572949, -73.238692],
    [44.570780, -73.241266],
    [44.567077, -73.238155],
    [44.563052, -73.239518],
    [44.559125, -73.239142],
    [44.554637, -73.246410],
    [44.555480, -73.249636],
    [44.551125, -73.262799],
    [44.550971, -73.274461],
    [44.553358, -73.276473],
    [44.556553, -73.280062],
    [44.557232, -73.282462],
    [44.552680, -73.287760],
    [44.551843, -73.294164],
    [44.555600, -73.295670],
    [44.555989, -73.298707],
    [44.553515, -73.304879],
    [44.553280, -73.309649],
    [44.551885, -73.310136],
    [44.550621, -73.303728],
    [44.548334, -73.296890],
    [44.545168, -73.292121],
    [44.541683, -73.283711],
    [44.538178, -73.278296],
    [44.534826, -73.278346],
    [44.531862, -73.277999],
    [44.529702, -73.273513],
    [44.525734, -73.272782],
    [44.521077, -73.269656],
    [44.515301, -73.269118],
    [44.512495, -73.271044],
    [44.511019, -73.273275],
    [44.506236, -73.276963],
    [44.503312, -73.275144],
    [44.501071, -73.272586],
    [44.498655, -73.272607],
    [44.503193, -73.271953],
    [44.504284, -73.266302],
    [44.501733, -73.253210],
    [44.498302, -73.246448],
    [44.495189, -73.246822],
    [44.489442, -73.249428],
    [44.489670, -73.246890],
    [44.491764, -73.245303],
    [44.492020, -73.240451],
    [44.488348, -73.231330],
    [44.484932, -73.227903],
    [44.482346, -73.224604],
    [44.480258, -73.222882],
    [44.477278, -73.221410],
    [44.474183, -73.221811],
    [44.471678, -73.220593],
    [44.468938, -73.218998],
    [44.463423, -73.220409],
    [44.458867, -73.223988],
    [44.456553, -73.225868],
    [44.454119, -73.231164],
    [44.450740, -73.232600],
    [44.449660, -73.230986],
    [44.445617, -73.232179],
    [44.442852, -73.231549],
    [44.442722, -73.224575],
    [44.440369, -73.221021],
    [44.435272, -73.219411],
    [44.430042, -73.219672],
    [44.426727, -73.218090],
    [44.423152, -73.218242],
    [44.418972, -73.218112],
    [44.413562, -73.220823],
    [44.407581, -73.222742],
    [44.405207, -73.222777],
    [44.401444, -73.224202],
    [44.399591, -73.231780],
    [44.400043, -73.234550],
    [44.401970, -73.237199],
    [44.405782, -73.238978],
    [44.408631, -73.238506],
    [44.410548, -73.239793],
    [44.411437, -73.243202],
    [44.413934, -73.245295],
    [44.417597, -73.245463],
    [44.418354, -73.249018],
    [44.420561, -73.250718],
    [44.423912, -73.251950],
    [44.427980, -73.249653],
    [44.431241, -73.246149],
    [44.433018, -73.248876],
    [44.435644, -73.246370],
    [44.438771, -73.246171],
    [44.441772, -73.248210],
    [44.442516, -73.250873],
    [44.439512, -73.254077],
    [44.436277, -73.253159],
    [44.433889, -73.251235],
    [44.430779, -73.254920],
    [44.428693, -73.257623],
    [44.424865, -73.256398],
    [44.420652, -73.257619],
    [44.417514, -73.258460],
    [44.415472, -73.255374],
    [44.411683, -73.257881],
    [44.408321, -73.261014],
    [44.405796, -73.264240],
    [44.403830, -73.268419],
    [44.403543, -73.271235],
    [44.399308, -73.272004],
    [44.397331, -73.277718],
    [44.394886, -73.279147],
    [44.391914, -73.277611],
    [44.387878, -73.276499],
    [44.384154, -73.273835],
    [44.381481, -73.276246],
    [44.383359, -73.279090],
    [44.381406, -73.281788],
    [44.378146, -73.280238],
    [44.378881, -73.279203],
    [44.381327, -73.277646],
    [44.379031, -73.273008],
    [44.377007, -73.268889],
    [44.373199, -73.269490],
    [44.371031, -73.268437],
    [44.368861, -73.270347],
    [44.365841, -73.272219],
    [44.364940, -73.267793],
    [44.361875, -73.266668],
    [44.359789, -73.270581],
    [44.356803, -73.270557],
    [44.352858, -73.271615],
    [44.350586, -73.276281],
    [44.348746, -73.280247],
    [44.347309, -73.284560],
    [44.343830, -73.282502],
    [44.340475, -73.281362],
    [44.336806, -73.281763],
    [44.333573, -73.282007],
    [44.331201, -73.286337],
    [44.326859, -73.289375],
    [44.322900, -73.291808],
    [44.319851, -73.292578],
    [44.315814, -73.294908],
    [44.309466, -73.296839],
    [44.307148, -73.301324],
    [44.303280, -73.302103],
    [44.301585, -73.296642],
    [44.298238, -73.294354],
    [44.296923, -73.296080],
    [44.298214, -73.299317],
    [44.298321, -73.301708],
    [44.296551, -73.302676],
    [44.294006, -73.300681],
    [44.291992, -73.304000],
    [44.291211, -73.298260],
    [44.292768, -73.294607],
    [44.293945, -73.291343],
    [44.295631, -73.287762],
    [44.292814, -73.285281],
    [44.288780, -73.288124],
    [44.289394, -73.284741],
    [44.286781, -73.281023],
    [44.282361, -73.282637],
    [44.280967, -73.285319],
    [44.281566, -73.288305],
    [44.278754, -73.291315],
    [44.276272, -73.295962],
    [44.273354, -73.298648],
    [44.270733, -73.301846],
    [44.268914, -73.303700],
    [44.266672, -73.304425],
    [44.267376, -73.302516],
    [44.268017, -73.299377],
    [44.269055, -73.295336],
    [44.265207, -73.297077],
    [44.267155, -73.292182],
    [44.271849, -73.288638],
    [44.274163, -73.288931],
    [44.275063, -73.284979],
    [44.274967, -73.278798],
    [44.271464, -73.278192],
    [44.271184, -73.272098],
    [44.267829, -73.269165],
    [44.269236, -73.266447],
    [44.269928, -73.265677],
    [44.268001, -73.266115],
    [44.265544, -73.264130],
    [44.266605, -73.267698],
    [44.264657, -73.270328],
    [44.261664, -73.271490],
    [44.258551, -73.269338],
    [44.257073, -73.269632],
    [44.256685, -73.272228],
    [44.257719, -73.275693],
    [44.255916, -73.276721],
    [44.254326, -73.278372],
    [44.253226, -73.280346],
    [44.255886, -73.283196],
    [44.251994, -73.279945],
    [44.248935, -73.279649],
    [44.247257, -73.279125],
    [44.244954, -73.280881],
    [44.243446, -73.281571],
    [44.242078, -73.286358],
    [44.240734, -73.288443],
    [44.242036, -73.291709],
    [44.243941, -73.297707],
    [44.245201, -73.299635],
    [44.241213, -73.297920],
    [44.239716, -73.295319],
    [44.237303, -73.296610],
    [44.236829, -73.299404],
    [44.236159, -73.302033],
    [44.238466, -73.302882],
    [44.241607, -73.302493],
    [44.241831, -73.307305],
    [44.237880, -73.309175],
    [44.236044, -73.312358],
    [44.237747, -73.316704],
    [44.235500, -73.318514],
    [44.233383, -73.316839],
    [44.231237, -73.317732],
    [44.229696, -73.313389],
    [44.224713, -73.314850],
    [44.224886, -73.318707],
    [44.227677, -73.320328],
    [44.229096, -73.322295],
    [44.227345, -73.325357],
    [44.224959, -73.324508],
    [44.224283, -73.322075],
    [44.221428, -73.317753],
    [44.217857, -73.319730],
    [44.216851, -73.325085],
    [44.217686, -73.329209],
    [44.219472, -73.333101],
    [44.219238, -73.335609],
    [44.217223, -73.337702],
    [44.214756, -73.344309],
    [44.212223, -73.346896],
    [44.211599, -73.350810],
    [44.208130, -73.352677],
    [44.204576, -73.355351],
    [44.205036, -73.356960],
    [44.201255, -73.357195],
    [44.199057, -73.359926],
    [44.199283, -73.362832],
    [44.196655, -73.362940],
    [44.195640, -73.364889],
    [44.194643, -73.368048],
    [44.190304, -73.370759],
    [44.184084, -73.371252],
    [44.181346, -73.370868],
    [44.180729, -73.369289],
    [44.181703, -73.362652],
    [44.179495, -73.355628],
    [44.176148, -73.350950],
    [44.169485, -73.354304],
    [44.163937, -73.359381],
    [44.159554, -73.361439],
    [44.151770, -73.364678],
    [44.148849, -73.366508],
    [44.146275, -73.366120],
    [44.147280, -73.369666],
    [44.144220, -73.371271],
    [44.141323, -73.370507],
    [44.140264, -73.366215],
    [44.136206, -73.366481],
    [44.132459, -73.368471],
    [44.126792, -73.373672],
    [44.122869, -73.376756],
    [44.118627, -73.378840],
    [44.117644, -73.382566],
    [44.114717, -73.385083],
    [44.111475, -73.387599],
    [44.105891, -73.388770],
    [44.100089, -73.388403],
    [44.097424, -73.387376],
    [44.093148, -73.388997],
    [44.091907, -73.394607],
    [44.089522, -73.397597],
    [44.087827, -73.400051],
    [44.086200, -73.404044],
    [44.084575, -73.408551],
    [44.081119, -73.409479],
    [44.079642, -73.412557],
    [44.076412, -73.414220],
    [44.070910, -73.414947],
    [44.068353, -73.413329],
    [44.064682, -73.411964],
    [44.062506, -73.415177],
    [44.058338, -73.416561],
    [44.055717, -73.417018],
    [44.052247, -73.417018],
    [44.050448, -73.421905],
    [44.047196, -73.424139],
    [44.044693, -73.419691],
    [44.041677, -73.419963],
    [44.040278, -73.420455],
    [44.035529, -73.421454],
    [44.034979, -73.418771],
    [44.033931, -73.412604],
    [44.030678, -73.407051],
    [44.028687, -73.400422],
    [44.026481, -73.400769],
    [44.024924, -73.398646],
    [44.022810, -73.400396],
    [44.018955, -73.394123],
    [44.013920, -73.393819],
    [44.009284, -73.396870],
    [44.003553, -73.397819],
    [44.000053, -73.400811],
    [43.997578, -73.399957],
    [43.993329, -73.402430],
    [43.989435, -73.399425],
    [43.985041, -73.398567],
    [43.981622, -73.398952],
    [43.978435, -73.398791],
    [43.978638, -73.402857],
    [43.975382, -73.407051],
    [43.969774, -73.404585],
    [43.965678, -73.404052],
    [43.960353, -73.405013],
    [43.957739, -73.405156],
    [43.954726, -73.404056],
    [43.950009, -73.402188],
    [43.946982, -73.401195],
    [43.942358, -73.396876],
    [43.938732, -73.397406],
    [43.936627, -73.400076],
    [43.937425, -73.402031],
    [43.935594, -73.403476],
    [43.931386, -73.402899],
    [43.927971, -73.399364],
    [43.926403, -73.392427],
    [43.924982, -73.392132],
    [43.920913, -73.392387],
    [43.916465, -73.394069],
    [43.912152, -73.394580],
    [43.908410, -73.393312],
    [43.905107, -73.393192],
    [43.906819, -73.385393],
    [43.903731, -73.379185],
    [43.902303, -73.374395],
    [43.899226, -73.373184],
    [43.894777, -73.373888],
    [43.890739, -73.374256],
    [43.885972, -73.374648],
    [43.884075, -73.372040],
    [43.879064, -73.367360],
    [43.874595, -73.366983],
    [43.869813, -73.366578],
    [43.864102, -73.372596],
    [43.861251, -73.372593],
    [43.858598, -73.373651],
    [43.855550, -73.376557],
    [43.852907, -73.373805],
    [43.850765, -73.372121],
    [43.851197, -73.368489],
    [43.849401, -73.369364],
    [43.846966, -73.367762],
    [43.841045, -73.367863],
    [43.837959, -73.371686],
    [43.834733, -73.370800],
    [43.831253, -73.377265],
    [43.835893, -73.381302],
    [43.833106, -73.383593],
    [43.830092, -73.385554],
    [43.828025, -73.384350],
    [43.824776, -73.389195],
    [43.820666, -73.390318],
    [43.818150, -73.387266],
    [43.816659, -73.384001],
    [43.814174, -73.379969],
    [43.810894, -73.377134],
    [43.807821, -73.375156],
    [43.803714, -73.374548],
    [43.800081, -73.375672],
    [43.798247, -73.370998],
    [43.796575, -73.367208],
    [43.794762, -73.364907],
    [43.796069, -73.357496],
    [43.794622, -73.355131],
    [43.789595, -73.352950],
    [43.785700, -73.351540],
    [43.781071, -73.352751],
    [43.778084, -73.349618],
    [43.775600, -73.343381],
    [43.771957, -73.344140],
    [43.768865, -73.344868],
    [43.765302, -73.342862],
    [43.761229, -73.347529],
    [43.758473, -73.351164],
    [43.752002, -73.357054],
    [43.748954, -73.360216],
    [43.743570, -73.364232],
    [43.743721, -73.366496],
    [43.740452, -73.367113],
    [43.735850, -73.367228],
    [43.733451, -73.367329],
    [43.729231, -73.366725],
    [43.725968, -73.368276],
    [43.722575, -73.367694],
    [43.721421, -73.368290],
    [43.719799, -73.366837],
    [43.718600, -73.367633],
    [43.717618, -73.373516],
    [43.713683, -73.379387],
    [43.712184, -73.384207],
    [43.708004, -73.387542],
    [43.704173, -73.390026],
    [43.700134, -73.391945],
    [43.697655, -73.390896],
    [43.697326, -73.390258],
    [43.694414, -73.388707],
    [43.696750, -73.392253],
    [43.693458, -73.394474],
    [43.691092, -73.395958],
    [43.691984, -73.393000],
    [43.690198, -73.395731],
    [43.688661, -73.397589],
    [43.684936, -73.402394],
    [43.681654, -73.401675],
    [43.679178, -73.399074],
    [43.676243, -73.403907],
    [43.672881, -73.407069],
    [43.668535, -73.407011],
    [43.666332, -73.407123],
    [43.664042, -73.408434],
    [43.662179, -73.411215],
    [43.660509, -73.409502],
    [43.659225, -73.406831],
    [43.656665, -73.405874],
    [43.654091, -73.403359],
    [43.654805, -73.406371],
    [43.657063, -73.407434],
    [43.656644, -73.410437],
    [43.654708, -73.412433],
    [43.652724, -73.413960],
    [43.649554, -73.415668],
    [43.646398, -73.421152],
    [43.643659, -73.425027],
    [43.640305, -73.424471],
    [43.637814, -73.426657],
    [43.636316, -73.425541],
    [43.633626, -73.426325],
    [43.630610, -73.423091],
    [43.627632, -73.420261],
    [43.624170, -73.417379],
    [43.621831, -73.413376],
    [43.619548, -73.415442],
    [43.614654, -73.416418],
    [43.610162, -73.418695],
    [43.608455, -73.418603],
    [43.607599, -73.420874],
    [43.611344, -73.422587],
    [43.613865, -73.420823],
    [43.612444, -73.423019],
    [43.607150, -73.421681],
    [43.603872, -73.420714],
    [43.601608, -73.419229],
    [43.598900, -73.419617],
    [43.597298, -73.418803],
    [43.595385, -73.420155],
    [43.594743, -73.420935],
    [43.592860, -73.418376],
    [43.592257, -73.419190],
    [43.592557, -73.422097],
    [43.587981, -73.425464],
    [43.585076, -73.426923],
    [43.588705, -73.428017],
    [43.591504, -73.425397],
    [43.591868, -73.428550],
    [43.588877, -73.430518],
    [43.583653, -73.426932],
    [43.578132, -73.419863],
    [43.571285, -73.407984],
    [43.573100, -73.413416],
    [43.574234, -73.417511],
    [43.574222, -73.420442],
    [43.574712, -73.421760],
    [43.575839, -73.423743],
    [43.573539, -73.426648],
    [43.570758, -73.428543],
    [43.566256, -73.426559],
    [43.563108, -73.428906],
    [43.560378, -73.431910],
    [43.557302, -73.435301],
    [43.555019, -73.437771],
    [43.552588, -73.443758],
    [43.550523, -73.445805],
    [43.549337, -73.448127],
    [43.547712, -73.453160],
    [43.545620, -73.456942],
    [43.543198, -73.461814],
    [43.541124, -73.466233],
    [43.538993, -73.468982],
    [43.537989, -73.472289],
    [43.536395, -73.473458],
    [43.535057, -73.472552],
    [43.535578, -73.475703],
    [43.534223, -73.476778],
    [43.533771, -73.482286],
    [43.531407, -73.483083],
    [43.532121, -73.485844],
    [43.533534, -73.486342],
    [43.536640, -73.479681],
    [43.538819, -73.478260],
    [43.542481, -73.474751],
    [43.544779, -73.470515],
    [43.547674, -73.466374],
    [43.548319, -73.462259],
    [43.551082, -73.455401],
    [43.553567, -73.453174],
    [43.557307, -73.451412],
    [43.559965, -73.452554],
    [43.557724, -73.449795],
    [43.559604, -73.447113],
    [43.562790, -73.446534],
    [43.563381, -73.445338],
    [43.564554, -73.440640],
    [43.565951, -73.439850],
    [43.569564, -73.437155],
    [43.570675, -73.441128],
    [43.572058, -73.439748],
    [43.573755, -73.440718],
    [43.572217, -73.436632],
    [43.573289, -73.433662],
    [43.574577, -73.433446],
    [43.576860, -73.437346],
    [43.577919, -73.434768],
    [43.580259, -73.432891],
    [43.579808, -73.436776],
    [43.583380, -73.435587],
    [43.581969, -73.432263],
    [43.585055, -73.432363],
    [43.582461, -73.428011],
    [43.586101, -73.431432],
    [43.590437, -73.431467],
    [43.598940, -73.426389],
    [43.601601, -73.425122],
    [43.606093, -73.425860],
    [43.610843, -73.426200],
    [43.616963, -73.421546],
    [43.621327, -73.418556],
    [43.625790, -73.421365],
    [43.631273, -73.426389],
    [43.633778, -73.428644],
    [43.637414, -73.431334],
    [43.640915, -73.432369],
    [43.648310, -73.427614],
    [43.652704, -73.423290],
    [43.653942, -73.419706],
    [43.653030, -73.422218],
    [43.652599, -73.419754],
    [43.656625, -73.416214],
    [43.660556, -73.414602],
    [43.663994, -73.413020],
    [43.668316, -73.412661],
    [43.673045, -73.409538],
    [43.675544, -73.408094],
    [43.678376, -73.406100],
    [43.684768, -73.404868],
    [43.687736, -73.406032],
    [43.691897, -73.405324],
    [43.694445, -73.399272],
    [43.701052, -73.395831],
    [43.706981, -73.393319],
    [43.711752, -73.391880],
    [43.715239, -73.385890],
    [43.718980, -73.379112],
    [43.723125, -73.376816],
    [43.728227, -73.371447],
    [43.730897, -73.372126],
    [43.736324, -73.373494],
    [43.740913, -73.374336],
    [43.745349, -73.371319],
    [43.752453, -73.367939],
    [43.758175, -73.366450],
    [43.766680, -73.364010],
    [43.766986, -73.366299],
    [43.768388, -73.367928],
    [43.771193, -73.369384],
    [43.773120, -73.371387],
    [43.774725, -73.372767],
    [43.777508, -73.372652],
    [43.777164, -73.377532],
    [43.773813, -73.378848],
    [43.771275, -73.377784],
    [43.768834, -73.377576],
    [43.770856, -73.378953],
    [43.772336, -73.381792],
    [43.772248, -73.385035],
    [43.773709, -73.381555],
    [43.775153, -73.382767],
    [43.776000, -73.380394],
    [43.777212, -73.380177],
    [43.778718, -73.376679],
    [43.779116, -73.373410],
    [43.778385, -73.370777],
    [43.775123, -73.370286],
    [43.772355, -73.368036],
    [43.769197, -73.364693],
    [43.767469, -73.363231],
    [43.770264, -73.362236],
    [43.774934, -73.363280],
    [43.782467, -73.364990],
    [43.786422, -73.366276],
    [43.788970, -73.368126],
    [43.791691, -73.372169],
    [43.795968, -73.373708],
    [43.796544, -73.377969],
    [43.800925, -73.379377],
    [43.803649, -73.383888],
    [43.805810, -73.385096],
    [43.802869, -73.388776],
    [43.801890, -73.392247],
    [43.803685, -73.390467],
    [43.806138, -73.389307],
    [43.809336, -73.387026],
    [43.809849, -73.392797],
    [43.814224, -73.395836],
    [43.816622, -73.399994],
    [43.820951, -73.399831],
    [43.825214, -73.399941],
    [43.828817, -73.399388],
    [43.833722, -73.399738],
    [43.835014, -73.395397],
    [43.836927, -73.398898],
    [43.839376, -73.399675],
    [43.841359, -73.395748],
    [43.838406, -73.395482],
    [43.836418, -73.394108],
    [43.838150, -73.393388],
    [43.840399, -73.390231],
    [43.838990, -73.385072],
    [43.842291, -73.382015],
    [43.845525, -73.379553],
    [43.849075, -73.383067],
    [43.852254, -73.385331],
    [43.855949, -73.386788],
    [43.856231, -73.390295],
    [43.856277, -73.391874],
    [43.856275, -73.397121],
    [43.857795, -73.395010],
    [43.858242, -73.393755],
    [43.858641, -73.390727],
    [43.860432, -73.385977],
    [43.864610, -73.387935],
    [43.868564, -73.386721],
    [43.871474, -73.386032],
    [43.876305, -73.384810],
    [43.878767, -73.390643],
    [43.883884, -73.391094],
    [43.888736, -73.390379],
    [43.891893, -73.391137],
    [43.893730, -73.396304],
    [43.899370, -73.398452],
    [43.902211, -73.401272],
    [43.903898, -73.410048],
    [43.906806, -73.414525],
    [43.912088, -73.413733],
    [43.915558, -73.410930],
    [43.921674, -73.412831],
    [43.924426, -73.414912],
    [43.927530, -73.417395],
    [43.931737, -73.416153],
    [43.934846, -73.413471],
    [43.936609, -73.415157],
    [43.939979, -73.415709],
    [43.943971, -73.415715],
    [43.944953, -73.413230],
    [43.948701, -73.413541],
    [43.952628, -73.411467],
    [43.955931, -73.413642],
    [43.957598, -73.411374],
    [43.960457, -73.411416],
    [43.964288, -73.412423],
    [43.966495, -73.414309],
    [43.971146, -73.416242],
    [43.974281, -73.419779],
    [43.977239, -73.420618],
    [43.981011, -73.419696],
    [43.983146, -73.418237],
    [43.985622, -73.420604],
    [43.988085, -73.419148],
    [43.990708, -73.420345],
    [43.995394, -73.416746],
    [43.998103, -73.413368],
    [44.000160, -73.414513],
    [44.004252, -73.417051],
    [44.007576, -73.415791],
    [44.010558, -73.416495],
    [44.013482, -73.417183],
    [44.017033, -73.418232],
    [44.021125, -73.417819],
    [44.024245, -73.417928],
    [44.026354, -73.417624],
    [44.027147, -73.420284],
    [44.030234, -73.421583],
    [44.030141, -73.425101],
    [44.031470, -73.430999],
    [44.030537, -73.435571],
    [44.029600, -73.441067],
    [44.029041, -73.440388],
    [44.027285, -73.437369],
    [44.025103, -73.435658],
    [44.021688, -73.435283],
    [44.017529, -73.436516],
    [44.014395, -73.434745],
    [44.009750, -73.435171],
    [44.005416, -73.436609],
    [44.004038, -73.448275],
    [44.002219, -73.442477],
    [43.999561, -73.438058],
    [44.001316, -73.442382],
    [43.999765, -73.447322],
    [44.000454, -73.451934],
    [44.002431, -73.452366],
    [44.006300, -73.451404],
    [44.008654, -73.451991],
    [44.012634, -73.452287],
    [44.014436, -73.455417],
    [44.020438, -73.455864],
    [44.024773, -73.456850],
    [44.032589, -73.460648],
    [44.034024, -73.457979],
    [44.037702, -73.457918],
    [44.040517, -73.457146],
    [44.042909, -73.456030],
    [44.047627, -73.455310],
    [44.051099, -73.452198],
    [44.053017, -73.453197],
    [44.057676, -73.450488],
    [44.062923, -73.449551],
    [44.067890, -73.449449],
    [44.073392, -73.447828],
    [44.079519, -73.446123],
    [44.088235, -73.444648],
    [44.092096, -73.444288],
    [44.094352, -73.444099],
    [44.098897, -73.446307],
    [44.100848, -73.444509],
    [44.104095, -73.439116],
    [44.105888, -73.435144],
    [44.111627, -73.433897],
    [44.111636, -73.430781],
    [44.112720, -73.428614],
    [44.115037, -73.427435],
    [44.120511, -73.425159],
    [44.130034, -73.425654],
    [44.133537, -73.426267],
    [44.136591, -73.426560],
    [44.139027, -73.426319],
    [44.141379, -73.424088],
    [44.143888, -73.421423],
    [44.143222, -73.418180],
    [44.144393, -73.416083],
    [44.145906, -73.412140],
    [44.150204, -73.409572],
    [44.152739, -73.406889],
    [44.153175, -73.403724],
    [44.157557, -73.405176],
    [44.160412, -73.405612],
    [44.160843, -73.404272],
    [44.164577, -73.404919],
    [44.167692, -73.412249],
    [44.169685, -73.416963],
    [44.172951, -73.421136],
    [44.175963, -73.424253],
    [44.178523, -73.427864],
    [44.181202, -73.430106],
    [44.185291, -73.432911],
    [44.188360, -73.434128],
    [44.191128, -73.432453],
    [44.192473, -73.427376],
    [44.194037, -73.423592],
    [44.195187, -73.422411],
    [44.196567, -73.418297],
    [44.197451, -73.410794],
    [44.197976, -73.406585],
    [44.197016, -73.402578],
    [44.199219, -73.400953],
    [44.200458, -73.399194],
    [44.199708, -73.393646],
    [44.199759, -73.391287],
    [44.201167, -73.392295],
    [44.200766, -73.387851],
    [44.203433, -73.384165],
    [44.205424, -73.383995],
    [44.205285, -73.379493],
    [44.207430, -73.375697],
    [44.210895, -73.374302],
    [44.210242, -73.372210],
    [44.213516, -73.369298],
    [44.217857, -73.364432],
    [44.220700, -73.360324],
    [44.224295, -73.360602],
    [44.228017, -73.363482],
    [44.230457, -73.358239],
    [44.232464, -73.358524],
    [44.235702, -73.357481],
    [44.237319, -73.353257],
    [44.240606, -73.351890],
    [44.242814, -73.346659],
    [44.247037, -73.342002],
    [44.248976, -73.338233],
    [44.251142, -73.334791],
    [44.254895, -73.330616],
    [44.256004, -73.328232],
    [44.259661, -73.326927],
    [44.260703, -73.324240],
    [44.263407, -73.324011],
    [44.266728, -73.322141],
    [44.269770, -73.322452],
    [44.268438, -73.327756],
    [44.267714, -73.337947],
    [44.270809, -73.346548],
    [44.274212, -73.349173],
    [44.279785, -73.348153],
    [44.286534, -73.346095],
    [44.289444, -73.345371],
    [44.292850, -73.348838],
    [44.298576, -73.350733],
    [44.302584, -73.348601],
    [44.305697, -73.348884],
    [44.308666, -73.348480],
    [44.311079, -73.351636],
    [44.315255, -73.347856],
    [44.322919, -73.346740],
    [44.329509, -73.347728],
    [44.333804, -73.350369],
    [44.337119, -73.354582],
    [44.340710, -73.356675],
    [44.344653, -73.357998],
    [44.350099, -73.359317],
    [44.353928, -73.356374],
    [44.357058, -73.358480],
    [44.359396, -73.355479],
    [44.361984, -73.356600],
    [44.364716, -73.360405],
    [44.368327, -73.361139],
    [44.371747, -73.361204],
    [44.376141, -73.363672],
    [44.377641, -73.366523],
    [44.377563, -73.371638],
    [44.382519, -73.372447],
    [44.383937, -73.375839],
    [44.389740, -73.376365],
    [44.394276, -73.375998],
    [44.397489, -73.379342],
    [44.399917, -73.381730],
    [44.403001, -73.378800],
    [44.402789, -73.375373],
    [44.406489, -73.374640],
    [44.411090, -73.369861],
    [44.413193, -73.366851],
    [44.415197, -73.364958],
    [44.416588, -73.370400],
    [44.420728, -73.371939],
    [44.427252, -73.372070],
    [44.434747, -73.373634],
    [44.438308, -73.376165],
    [44.441891, -73.375268],
    [44.444571, -73.375707],
    [44.448844, -73.377167],
    [44.445613, -73.379739],
    [44.442791, -73.383419],
    [44.437262, -73.385929],
    [44.433126, -73.389100],
    [44.429892, -73.391181],
    [44.427500, -73.393246],
    [44.422863, -73.392080],
    [44.415917, -73.391002],
    [44.412608, -73.390548],
    [44.411154, -73.396292],
    [44.409415, -73.397459],
    [44.405619, -73.397445],
    [44.402913, -73.392960],
    [44.400611, -73.391310],
    [44.399614, -73.388517],
    [44.396826, -73.389445],
    [44.394028, -73.393630],
    [44.396206, -73.398456],
    [44.394070, -73.401524],
    [44.391999, -73.404205],
    [44.391568, -73.405064],
    [44.395172, -73.406629],
    [44.396053, -73.410019],
    [44.400133, -73.413582],
    [44.405250, -73.415157],
    [44.409783, -73.416866],
    [44.412920, -73.414814],
    [44.415629, -73.415106],
    [44.421592, -73.412798],
    [44.427045, -73.410371],
    [44.429760, -73.409037],
    [44.434981, -73.404069],
    [44.438984, -73.401125],
    [44.442179, -73.400041],
    [44.446102, -73.399984],
    [44.448853, -73.398572],
    [44.453485, -73.396848],
    [44.456048, -73.397484],
    [44.458404, -73.396336],
    [44.460537, -73.396382],
    [44.461811, -73.396793],
    [44.465084, -73.396852],
    [44.468558, -73.399185],
    [44.468369, -73.403388],
    [44.472409, -73.409210],
    [44.475635, -73.411922],
    [44.481275, -73.415732],
    [44.484990, -73.416951],
    [44.488608, -73.414375],
    [44.492249, -73.408617],
    [44.495808, -73.404379],
    [44.499345, -73.399539],
    [44.502351, -73.395005],
    [44.505375, -73.389411],
    [44.507737, -73.386367],
    [44.509908, -73.385379],
    [44.513370, -73.384805],
    [44.517866, -73.385492],
    [44.519747, -73.387110],
    [44.521518, -73.392719],
    [44.522202, -73.400618],
    [44.527051, -73.404313],
    [44.532444, -73.407917],
    [44.537441, -73.415332],
    [44.543214, -73.419928],
    [44.547974, -73.425439],
    [44.555573, -73.423596],
    [44.559305, -73.424506],
    [44.564509, -73.423481],
    [44.566897, -73.422084],
    [44.570016, -73.421907],
    [44.572873, -73.430498],
    [44.575021, -73.434760],
    [44.578901, -73.436390],
    [44.581790, -73.438308],
    [44.586952, -73.439229],
    [44.593086, -73.439746],
    [44.597274, -73.438459],
    [44.602461, -73.437687],
    [44.605788, -73.438033],
    [44.607509, -73.439335],
    [44.610159, -73.436393],
    [44.615153, -73.437941],
    [44.618031, -73.440021],
    [44.620370, -73.444411],
    [44.624933, -73.447264],
    [44.629412, -73.443986],
    [44.633478, -73.445565],
    [44.636990, -73.438492],
    [44.641286, -73.435953],
    [44.644833, -73.433435],
    [44.647533, -73.436192],
    [44.650238, -73.436521],
    [44.653622, -73.436991],
    [44.655806, -73.439085],
    [44.662029, -73.440336],
    [44.669768, -73.442122],
    [44.679013, -73.441333],
    [44.683319, -73.443555],
    [44.688914, -73.444407],
    [44.692178, -73.444422],
    [44.695231, -73.442398],
    [44.697971, -73.440713],
    [44.699278, -73.444919],
    [44.700749, -73.445901],
    [44.704961, -73.444820],
    [44.707066, -73.441359],
    [44.708229, -73.443110],
    [44.708685, -73.447142],
    [44.711032, -73.447839],
    [44.715633, -73.443304],
    [44.716999, -73.440943],
    [44.721837, -73.426843],
    [44.723080, -73.417804],
    [44.721402, -73.414580],
    [44.718352, -73.411598],
    [44.714745, -73.410442],
    [44.709096, -73.407037],
    [44.704159, -73.401468],
    [44.699710, -73.397908],
    [44.695789, -73.394649],
    [44.693199, -73.391753],
    [44.690714, -73.385990],
    [44.693450, -73.383104],
    [44.696436, -73.381302],
    [44.700750, -73.380620],
    [44.704098, -73.381960],
    [44.708933, -73.381941],
    [44.713329, -73.379727],
    [44.718362, -73.378409],
    [44.722750, -73.385364],
    [44.727542, -73.387488],
    [44.732399, -73.391505],
    [44.731464, -73.395954],
    [44.734155, -73.399717],
    [44.737147, -73.404479],
    [44.742367, -73.406589],
    [44.743092, -73.408599],
    [44.745875, -73.413485],
    [44.747369, -73.417122],
    [44.749455, -73.413634],
    [44.751025, -73.411076],
    [44.760451, -73.409213],
    [44.766174, -73.408043],
    [44.771477, -73.406157],
    [44.773989, -73.396939],
    [44.775153, -73.391743],
    [44.772797, -73.388992],
    [44.773380, -73.387740],
    [44.773080, -73.385372],
    [44.771147, -73.386163],
    [44.775861, -73.382483],
    [44.778951, -73.378517],
    [44.776131, -73.379585],
    [44.769362, -73.383711],
    [44.764744, -73.383462],
    [44.768163, -73.379324],
    [44.774419, -73.375556],
    [44.777221, -73.375865],
    [44.781938, -73.371713],
    [44.784502, -73.369915],
    [44.784367, -73.366481],
    [44.786158, -73.366668],
    [44.787775, -73.367422],
    [44.790381, -73.364206],
    [44.793114, -73.364066],
    [44.796968, -73.361163],
    [44.801033, -73.360452],
    [44.803870, -73.364664],
    [44.806732, -73.365097],
    [44.809506, -73.367333],
    [44.812197, -73.370047],
    [44.815451, -73.369882],
    [44.818576, -73.370372],
    [44.820327, -73.371792],
    [44.820139, -73.376034],
    [44.817400, -73.378439],
    [44.814291, -73.383233],
    [44.814444, -73.388206],
    [44.810752, -73.389167],
    [44.814478, -73.390198],
    [44.816097, -73.397506],
    [44.819723, -73.399862],
    [44.824492, -73.401142],
    [44.828998, -73.403589],
    [44.833249, -73.405933],
    [44.834596, -73.409178],
    [44.838795, -73.409620],
    [44.843117, -73.402097],
    [44.842996, -73.395575],
    [44.844549, -73.394388],
    [44.848832, -73.392915],
    [44.851376, -73.387252],
    [44.854367, -73.386863],
    [44.856776, -73.389060],
    [44.858462, -73.392023],
    [44.861052, -73.393389],
    [44.863797, -73.394287],
    [44.867764, -73.394809],
    [44.870642, -73.393460],
    [44.872581, -73.386378],
    [44.874343, -73.383416],
    [44.876228, -73.380868],
    [44.878280, -73.378257],
    [44.880870, -73.379568],
    [44.884729, -73.376798],
    [44.887452, -73.376771],
    [44.890617, -73.378067],
    [44.893761, -73.378524],
    [44.897580, -73.379739],
    [44.899780, -73.380947],
    [44.903302, -73.380096],
    [44.905277, -73.378853],
    [44.905009, -73.376090],
    [44.907575, -73.375387],
    [44.911197, -73.374793],
    [44.914172, -73.375474],
    [44.917709, -73.377937],
    [44.919709, -73.378867],
    [44.922462, -73.381272],
    [44.926794, -73.385105],
    [44.930423, -73.384846],
    [44.933424, -73.385571],
    [44.937136, -73.386288],
    [44.940137, -73.385177],
    [44.942544, -73.383616],
    [44.946893, -73.380880],
    [44.949862, -73.375679],
    [44.950927, -73.369512],
    [44.949295, -73.367473],
    [44.944189, -73.363660],
    [44.941172, -73.363633],
    [44.939383, -73.364262],
    [44.935980, -73.363323],
    [44.934024, -73.361526],
    [44.935379, -73.356475],
    [44.939750, -73.353401],
    [44.945791, -73.350774],
    [44.948235, -73.353037],
    [44.951323, -73.355428],
    [44.955481, -73.354568],
    [44.955594, -73.356471],
    [44.958057, -73.359861],
    [44.965345, -73.358372],
    [44.970468, -73.355961],
    [44.973968, -73.360203],
    [44.977482, -73.363303],
    [44.981953, -73.362782],
    [44.984949, -73.363303],
    [44.989015, -73.363475],
    [44.990877, -73.363719],
    [44.995046, -73.360713],
    [44.996590, -73.359777],
    [44.998966, -73.358208],
    [45.000926, -73.354432],
    [45.005708, -73.350528],
    [45.005873, -73.348030],
    [45.005842, -73.350606],
    [45.008067, -73.351872],
    [45.011383, -73.351778],
    [45.014107, -73.352843],
    [45.015846, -73.353548],
    [45.019274, -73.353571],
    [45.020753, -73.355766],
    [45.021472, -73.356096],
    [45.022699, -73.354388],
    [45.024347, -73.350952],
    [45.028551, -73.350752],
    [45.033304, -73.349491],
    [45.035167, -73.347939],
    [45.040799, -73.343351],
    [45.043720, -73.340184],
    [45.046310, -73.338240],
    [45.049061, -73.337911],
    [45.052875, -73.335607],
    [45.055384, -73.335544],
    [45.057251, -73.334385],
    [45.060707, -73.334167],
    [45.062085, -73.329650],
    [45.059779, -73.327784],
    [45.057001, -73.324460],
    [45.060665, -73.323315],
    [45.063683, -73.320610],
    [45.060996, -73.321534],
    [45.056317, -73.321888],
    [45.052118, -73.323632],
    [45.048019, -73.324053],
    [45.044472, -73.325735],
    [45.040739, -73.326080],
    [45.035954, -73.327096],
    [45.032971, -73.328892],
    [45.031508, -73.331212],
    [45.029284, -73.331847],
    [45.025802, -73.334011],
    [45.022820, -73.334019],
    [45.016757, -73.334803],
    [45.009957, -73.335776],
    [45.006356, -73.334117],
    [45.001628, -73.331630],
    [44.999166, -73.332671],
    [44.998357, -73.339705],
    [44.997326, -73.332286],
    [44.995186, -73.330707],
    [44.993693, -73.328404],
    [44.990026, -73.331924],
    [44.991853, -73.336037],
    [44.992196, -73.340774],
    [44.989733, -73.342406],
    [44.987026, -73.342248],
    [44.982405, -73.342225],
    [44.981748, -73.340611],
    [44.985484, -73.338238],
    [44.985404, -73.327529],
    [44.983395, -73.314575],
    [44.981117, -73.311008],
    [44.977977, -73.310195],
    [44.974285, -73.310541],
    [44.970880, -73.307246],
    [44.968454, -73.304433],
    [44.964484, -73.304867],
    [44.958775, -73.305963],
    [44.953085, -73.306289],
    [44.949506, -73.308522],
    [44.943729, -73.311591],
    [44.937557, -73.312682],
    [44.932471, -73.313384],
    [44.929420, -73.308897],
    [44.924161, -73.309337],
    [44.920392, -73.311171],
    [44.912908, -73.314083],
    [44.906568, -73.313170],
    [44.904304, -73.312966],
    [44.902932, -73.304990],
    [44.896338, -73.304688],
    [44.890358, -73.304045],
    [44.885432, -73.302057],
    [44.881134, -73.305058],
    [44.875220, -73.307899],
    [44.872205, -73.310692],
    [44.869266, -73.310177],
    [44.867806, -73.308256],
    [44.867558, -73.306096],
    [44.865498, -73.304478],
    [44.863972, -73.296020],
    [44.859471, -73.292395],
    [44.854812, -73.293647],
    [44.849166, -73.294563],
    [44.847933, -73.292861],
    [44.855169, -73.289610],
    [44.860037, -73.287835],
    [44.862495, -73.286532],
    [44.862278, -73.287463],
    [44.868755, -73.283613],
    [44.872883, -73.281882],
    [44.878122, -73.280873],
    [44.882758, -73.278852],
    [44.885924, -73.277477],
    [44.889895, -73.277305],
    [44.894532, -73.276732],
    [44.898115, -73.274630],
    [44.901377, -73.273157],
    [44.906718, -73.271661],
    [44.908200, -73.269359],
    [44.912773, -73.268391],
    [44.912471, -73.272002],
    [44.916477, -73.275601],
    [44.919837, -73.274203],
    [44.922917, -73.270239],
    [44.925554, -73.267629],
    [44.928364, -73.266608],
    [44.928552, -73.263479],
    [44.932832, -73.264534],
    [44.935251, -73.260401],
    [44.937779, -73.260249],
    [44.940541, -73.261393],
    [44.939639, -73.261170],
    [44.942329, -73.260996],
    [44.950035, -73.264068],
    [44.955230, -73.264550],
    [44.958201, -73.260813],
    [44.959768, -73.256314],
    [44.961281, -73.252116],
    [44.962455, -73.245824],
    [44.962984, -73.240358],
    [44.964825, -73.235623],
    [44.967190, -73.233413],
    [44.970807, -73.230795],
    [44.972455, -73.228665],
    [44.975003, -73.226909],
    [44.975005, -73.226213],
    [44.978686, -73.225358],
    [44.981072, -73.224014],
    [44.986039, -73.221128],
    [44.989760, -73.217870],
    [44.994682, -73.217912],
    [44.998192, -73.215486],
    [45.002272, -73.214057],
    [45.006167, -73.212561],
    [45.010026, -73.211320],
    [45.014233, -73.207840],
    [45.015449, -73.200187],
    [45.015148, -73.195057],
    [45.012351, -73.193875],
    [45.013469, -73.191485],
    [45.018873, -73.188291],
    [45.021994, -73.185181],
    [45.025217, -73.183381],
    [45.028025, -73.180551],
    [45.029711, -73.176965],
    [45.034319, -73.171861],
    [45.038137, -73.171685],
    [45.045130, -73.170106],
    [45.048410, -73.169809],
    [45.051184, -73.169122],
    [45.055948, -73.169275],
    [45.058698, -73.166284],
    [45.059217, -73.161180],
    [45.059854, -73.158807],
    [45.064089, -73.155954],
    [45.068361, -73.154359],
    [45.074388, -73.152842],
    [45.078252, -73.151880],
    [45.084951, -73.146776],
    [45.085126, -73.142236]
];

// ============================================
// Grid Configuration - Updated for KMZ bounds
// ============================================
const GRID_CONFIG = {
    latStep: 0.00450,
    lngStep: 0.00600,
    bounds: {
        south: 43.5300,
        north: 45.0900,
        west: -73.5200,
        east: -73.0700
    }
};

// ============================================
// Point in Polygon Check (Ray Casting)
// ============================================
function pointInPolygon(lat, lng, polygon) {
    let inside = false;
    const n = polygon.length;

    for (let i = 0, j = n - 1; i < n; j = i++) {
        const [yi, xi] = polygon[i];
        const [yj, xj] = polygon[j];

        if (((yi > lat) !== (yj > lat)) &&
            (lng < (xj - xi) * (lat - yi) / (yj - yi) + xi)) {
            inside = !inside;
        }
    }

    return inside;
}

function isInWater(lat, lng) {
    return pointInPolygon(lat, lng, LAKE_CHAMPLAIN_POLYGON);
}

// ============================================
// Haversine Distance (km)
// ============================================
function haversineDistance(lat1, lng1, lat2, lng2) {
    const R = 6371;
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLng = (lng2 - lng1) * Math.PI / 180;

    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
              Math.sin(dLng / 2) * Math.sin(dLng / 2);

    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
}

// ============================================
// Grid Generation
// ============================================
let waterGrid = null;
let gridIndex = null;

function generateWaterGrid() {
    if (waterGrid !== null) {
        return waterGrid;
    }

    console.log('Generating water grid with KMZ polygon (1624 vertices)...');
    const startTime = performance.now();

    waterGrid = [];
    gridIndex = {};

    const { south, north, west, east } = GRID_CONFIG.bounds;
    const { latStep, lngStep } = GRID_CONFIG;

    let id = 0;

    for (let lat = south; lat <= north; lat += latStep) {
        for (let lng = west; lng <= east; lng += lngStep) {
            if (isInWater(lat, lng)) {
                const point = {
                    id: `g${id}`,
                    lat: Math.round(lat * 1000000) / 1000000,
                    lng: Math.round(lng * 1000000) / 1000000,
                    row: Math.round((lat - south) / latStep),
                    col: Math.round((lng - west) / lngStep)
                };
                waterGrid.push(point);

                const key = `${point.row},${point.col}`;
                gridIndex[key] = point;

                id++;
            }
        }
    }

    const endTime = performance.now();
    console.log(`Generated ${waterGrid.length} water grid points in ${(endTime - startTime).toFixed(0)}ms`);

    return waterGrid;
}

// ============================================
// Find Neighbors (8-directional connectivity)
// ============================================
function getNeighbors(point) {
    const neighbors = [];
    const { row, col } = point;

    const directions = [
        [-1, 0], [-1, 1], [0, 1], [1, 1],
        [1, 0], [1, -1], [0, -1], [-1, -1]
    ];

    for (const [dr, dc] of directions) {
        const key = `${row + dr},${col + dc}`;
        if (gridIndex[key]) {
            neighbors.push(gridIndex[key]);
        }
    }

    return neighbors;
}

// ============================================
// A* Pathfinding Algorithm
// ============================================
function findPath(startLat, startLng, endLat, endLng) {
    generateWaterGrid();

    const startPoint = findNearestGridPoint(startLat, startLng);
    const endPoint = findNearestGridPoint(endLat, endLng);

    if (!startPoint || !endPoint) {
        console.warn('Could not find grid points for route');
        return null;
    }

    const openSet = new Map();
    openSet.set(startPoint.id, startPoint);

    const cameFrom = {};
    const gScore = {};
    const fScore = {};

    for (const p of waterGrid) {
        gScore[p.id] = Infinity;
        fScore[p.id] = Infinity;
    }

    gScore[startPoint.id] = 0;
    fScore[startPoint.id] = haversineDistance(startPoint.lat, startPoint.lng, endPoint.lat, endPoint.lng);

    const pointById = {};
    for (const p of waterGrid) {
        pointById[p.id] = p;
    }

    const closedSet = new Set();

    while (openSet.size > 0) {
        let current = null;
        let lowestF = Infinity;

        for (const [id, point] of openSet) {
            if (fScore[id] < lowestF) {
                lowestF = fScore[id];
                current = point;
            }
        }

        if (!current) break;

        if (current.id === endPoint.id) {
            const path = [current];
            let curr = current.id;
            while (cameFrom[curr]) {
                curr = cameFrom[curr];
                path.unshift(pointById[curr]);
            }

            let totalDistance = 0;
            for (let i = 0; i < path.length - 1; i++) {
                totalDistance += haversineDistance(
                    path[i].lat, path[i].lng,
                    path[i + 1].lat, path[i + 1].lng
                );
            }

            return { path, distance: totalDistance };
        }

        openSet.delete(current.id);
        closedSet.add(current.id);

        for (const neighbor of getNeighbors(current)) {
            if (closedSet.has(neighbor.id)) continue;

            const tentativeG = gScore[current.id] +
                haversineDistance(current.lat, current.lng, neighbor.lat, neighbor.lng);

            if (tentativeG < gScore[neighbor.id]) {
                cameFrom[neighbor.id] = current.id;
                gScore[neighbor.id] = tentativeG;
                fScore[neighbor.id] = tentativeG +
                    haversineDistance(neighbor.lat, neighbor.lng, endPoint.lat, endPoint.lng);

                if (!openSet.has(neighbor.id)) {
                    openSet.set(neighbor.id, neighbor);
                }
            }
        }
    }

    console.warn('No water path found');
    return null;
}

// ============================================
// Find Nearest Grid Point to coordinates
// ============================================
function findNearestGridPoint(lat, lng) {
    generateWaterGrid();

    let nearest = null;
    let nearestDist = Infinity;

    for (const point of waterGrid) {
        const dist = haversineDistance(lat, lng, point.lat, point.lng);
        if (dist < nearestDist) {
            nearestDist = dist;
            nearest = point;
        }
    }

    return nearest;
}

// ============================================
// Main Water Route Calculation
// ============================================
function calculateWaterRoute(startPoiId, endPoiId) {
    const startPoi = POINTS_OF_INTEREST.find(p => p.id === startPoiId);
    const endPoi = POINTS_OF_INTEREST.find(p => p.id === endPoiId);

    if (!startPoi || !endPoi) {
        console.warn('POI not found:', startPoiId, endPoiId);
        return null;
    }

    if (startPoiId === endPoiId) {
        return {
            coordinates: [[startPoi.lat, startPoi.lng]],
            distance: 0,
            path: []
        };
    }

    const pathResult = findPath(startPoi.lat, startPoi.lng, endPoi.lat, endPoi.lng);

    if (!pathResult) {
        const directDistance = haversineDistance(
            startPoi.lat, startPoi.lng,
            endPoi.lat, endPoi.lng
        );
        return {
            coordinates: [
                [startPoi.lat, startPoi.lng],
                [endPoi.lat, endPoi.lng]
            ],
            distance: directDistance,
            path: [],
            isFallback: true
        };
    }

    let finalPath = pathResult.path;

    console.log(`Route found: ${finalPath.length} waypoints`);

    const coordinates = [[startPoi.lat, startPoi.lng]];
    for (const point of finalPath) {
        coordinates.push([point.lat, point.lng]);
    }
    coordinates.push([endPoi.lat, endPoi.lng]);

    const startGridDist = haversineDistance(
        startPoi.lat, startPoi.lng,
        pathResult.path[0].lat, pathResult.path[0].lng
    );
    const endGridDist = haversineDistance(
        endPoi.lat, endPoi.lng,
        pathResult.path[pathResult.path.length - 1].lat,
        pathResult.path[pathResult.path.length - 1].lng
    );

    return {
        coordinates,
        distance: startGridDist + pathResult.distance + endGridDist,
        path: finalPath.map(p => p.id)
    };
}

// ============================================
// Pre-generate grid on page load
// ============================================
if (typeof window !== 'undefined') {
    setTimeout(() => {
        generateWaterGrid();
    }, 100);
}

// ============================================
// Exports
// ============================================
if (typeof window !== 'undefined') {
    window.calculateWaterRoute = calculateWaterRoute;
    window.haversineDistance = haversineDistance;
    window.isInWater = isInWater;
    window.findNearestGridPoint = findNearestGridPoint;
    window.generateWaterGrid = generateWaterGrid;
    window.LAKE_CHAMPLAIN_POLYGON = LAKE_CHAMPLAIN_POLYGON;
}
